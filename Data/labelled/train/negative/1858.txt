All the ferries had run into trouble just outside the Stockholm archipelago , made up of more than 20,000 islands .